mapper.py
#! /user/bin/envy
python
"""mapper.py"""
import sys
# input comes from STDIN (standard input)
for line in sys.stdin:
# remove leading and trailing whitespace
line = line.strip()
# split the line into words
words = line.split()
# increase counters
for word in words:
# write the results to STDOUT (standard output);
# what we output here will be the input for the
# Reduce step, i.e. the input for reducer.py
#
# tab-delimited; the trivial word count is 1
print('%s\t%s' % (word, 1))



reducer.py
#!/usr/bin/env python
"""reducer.py"""
fromoperator import itemgetter
import sys
current_word = None
current_count = 0
word = None
# input comesfromSTDIN
for line in sys.stdin:
# remove leading and trailing whitespace
line = line.strip()
# parse the input we got from mapper.py
word, count = line.split('\t', 1)
# convert count (currently a string) to int
try:
count = int(count)
except ValueError:
# count was not a number, so silently
Dept of AIML,GAT 10 BDA Lab â€“ 22AML54
# ignore/discard this line
continue
# this IF-switch only works because Hadoop sorts map output
# by key (here: word) before it is passed to the reducer
if current_word == word:
current_count += count
else:
if current_word:
# write result to STDOUT
print('%s\t%s' % (current_word, current_count))
current_count = count
current_word = word
# do not forget to output the last word if needed!
if current_word == word:
print('%s\t%s' % (current_word, current_count))


Step 2. Create input.txt file
$sudo nano input.txt
input.txt
Global Academy of Technology (GAT), established in the year 2001, is one of the most soughtafter engineering and management colleges in Bengaluru, Karnataka. Located in a sprawling
campus of 10-acre land, GAT is a campus ideal for students to hone their academics in an
atmosphere of optimism. The institute is enabled with :
GAT provides ample opportunities for various co-curricular and extra-curricular activities for the
students. The campus brims with more than 3500 students and 300 experienced staff involved in
effective Teaching and Learning Process. Academics is supplemented with mentoring, peer
learning and counselling to ensure holistic development of students. GAT has academic alliances
with various institutions, industries, and research organizations to provide industry perspective to
the students.
Step 3. Run the map-reduce word count program on UNIX platform
$cat input.txt | python3 mapper.py |sort | python3 reducer.py
Step 4. Run the map-reduce word count program on Hadoop
1. $sudo su hduser
2. $ start-dfs.sh
3. $start-yarn.sh
4. $jps
5. $hafs dfs -put /input.txt /
6. hadoop jar /usr/local/hadoop/share/hadoop/tools/lib/hadoop-streaming 3.3.4.jar -files
./mapper.py,./reducer.py -mapper "python3 mapper.py" -reducer "python3 reducer.py" -input
/5000-8.txt -output /0000009
7. Observe the result in localhost:port_number
8. Download outputfile and view it for wordcount
